<template name="userwallet">    
    <div class="col-sm7 col-sm-offset-1">
  
        <div class="row">
            <div class="col-sm-12" id="wallet-balance">
                <div class="row">
                    <h2>Your Account</h2>
                        <span>Current Balance</span><br />
                        <span style="font-weight: bolder; font-size: 4.2em">{{formatPrice getAccountBalance}}</span>
                </div>
                <div class="row">
                    <h2>Top Up Wallet</h2>
                    <div class="col-xs-3">
                            <input id="topUpAmount" style="margin-top: 5px; margin-bottom: 5px;" class="form-control" type="number" name="amount" placeholder="amount">
                    </div>
                    <button style="margin-top: 5px; margin-bottom: 5px;" id="top-up-btn" onclick="payWithPaystack()" class="btn btn-success">Top Up</button>
                    <form>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script>
      var payStackDetails = {
      key: 'pk_test_2594e8950a3a70fc754d143c4fc6721e8138f70c',
      email: '{{getCustomerEmail}}',
      ref: "{{generateTransactionID}}",
      callback: function(response){
        Blaze._getTemplate("userwallet").__helpers[" handlePayment"](response.reference);
      },    
      onClose: function(){
        swal("Cancelled","You cancelled the payment","warning");
      },
    };
    
    function payWithPaystack(){
        const amount = $('#topUpAmount')[0].value;
        console.log(amount);
        payStackDetails.amount = amount * 100;
        var handler = PaystackPop.setup(payStackDetails);
        handler.openIframe();
  }
    </script>
  </form>
                </div>
                <div class="row">
                    <h2>Transfer</h2>
                    <div class="col-xs-3">
                            <input id="transfer_amount" style="margin-top: 5px; margin-bottom: 5px;" class="form-control" type="number" name="amount" placeholder="amount">
                    </div>
                    <div class="col-xs-3">
                            <input id="transfer_email" style="margin-top: 5px; margin-bottom: 5px;" class="form-control" type="text" name="email" placeholder="user-email-address">
                    </div>
                    <button style="margin-top: 5px; margin-bottom: 5px;" id="transfer-btn" class="btn btn-success">Transfer</button>
                </div>
            </div>
            <div class="col-sm-10" id="transactions">
                <div class="row">
                    <h2>Transactions</h2>

                    <table class="table table-striped table-bordered">
                        <thead>
                            <th>Transaction Type</th>
                            <th>Amount</th>
                            <th>Date and Time</th>
                        </thead>
                        <tbody>
                    {{#each transaction in getTransactions }}
                        <tr>
                            <td>{{capitalizeFirstLetter transaction.transactionType}}</td>
                            <td>{{formatPrice transaction.amount}}</td>
                            <td>{{formatDate transaction.createdAt}}</td>
                        </tr>
                    {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-2">
    </div>
</template>